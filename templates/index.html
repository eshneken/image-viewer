<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ app_title }}</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <header>
        <h1><i class="fas fa-images"></i> {{ app_title }}</h1>
        <div class="stats">
            <span id="total-images">{{ pagination.total_images }} images</span>
            <span id="current-page">Page {{ pagination.current_page }} of {{ pagination.total_pages }}</span>
        </div>
    </header>

    <div class="container">
        <!-- Loading indicator -->
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>Loading images...</p>
        </div>

        <!-- Image Gallery -->
        <div id="gallery" class="gallery">
            {% for image in images %}
            <div class="image-card" data-image-name="{{ image.name }}" data-image-url="{{ image.url }}">
                <div class="image-container">
                    {% if image.thumbnail %}
                    <img src="{{ image.thumbnail }}" alt="{{ image.name }}" class="gallery-image" loading="lazy">
                    {% else %}
                    <div class="image-placeholder">
                        <i class="fas fa-image"></i>
                        <span>{{ image.name }}</span>
                    </div>
                    {% endif %}
                    <div class="image-overlay">
                        <button class="view-btn" data-image-name="{{ image.name }}" data-image-url="{{ image.url }}">
                            <i class="fas fa-expand"></i>
                        </button>
                    </div>
                </div>
                <div class="image-info">
                    <span class="image-name">{{ image.name }}</span>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- Pagination -->
        <div class="pagination">
            {% if pagination.has_prev %}
            <button class="page-btn" onclick="changePage({{ pagination.current_page - 1 }})">
                <i class="fas fa-chevron-left"></i> Previous
            </button>
            {% endif %}
            
            <div class="page-numbers">
                {% for page_num in range(1, pagination.total_pages + 1) %}
                    {% if page_num == pagination.current_page %}
                    <span class="page-number active">{{ page_num }}</span>
                    {% elif page_num <= 3 or page_num > pagination.total_pages - 3 or (page_num >= pagination.current_page - 1 and page_num <= pagination.current_page + 1) %}
                    <button class="page-number" onclick="changePage({{ page_num }})">{{ page_num }}</button>
                    {% elif page_num == 4 and pagination.current_page > 6 %}
                    <span class="page-ellipsis">...</span>
                    {% elif page_num == pagination.total_pages - 3 and pagination.current_page < pagination.total_pages - 5 %}
                    <span class="page-ellipsis">...</span>
                    {% endif %}
                {% endfor %}
            </div>

            {% if pagination.has_next %}
            <button class="page-btn" onclick="changePage({{ pagination.current_page + 1 }})">
                Next <i class="fas fa-chevron-right"></i>
            </button>
            {% endif %}
        </div>
    </div>

    <!-- Modal -->
    <div id="imageModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Image Viewer</h3>
                <button class="close-btn" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="image-display">
                    <div id="imageLoading" class="image-loading">
                        <div class="spinner"></div>
                        <p>Loading image...</p>
                    </div>
                    <img id="modalImage" src="" alt="" class="modal-image">
                </div>
                <div class="image-details">
                    <h4 id="imageName"></h4>
                    <p id="imageCounter"></p>
                </div>
            </div>
            <button id="prevBtn" class="nav-btn prev" onclick="navigateImage(-1)">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button id="nextBtn" class="nav-btn next" onclick="navigateImage(1)">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
